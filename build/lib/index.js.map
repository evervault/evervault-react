{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap","webpack:///./node_modules/@evervault/sdk/index.js","webpack:///external \"react\"","webpack:///./index.js","webpack:///./node_modules/@evervault/sdk/utils.js"],"names":["root","factory","exports","module","require","define","amd","a","i","window","__WEBPACK_EXTERNAL_MODULE__1__","installedModules","__webpack_require__","moduleId","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","Utils","keyStore","_privateKey","undefined","this","encryptString","str","dataBuffer","dataToBuffer","iv","crypto","getRandomValues","Uint8Array","subtle","encrypt","then","enc","buildEvervaultString","catch","err","Error","decryptString","isEvervaultString","parsedData","parseEvervaultString","b64ToBuffer","browserData","ivBuffer","decrypt","decryptedData","bufferToString","error","updateKey","async","newKey","keyObj","getEncryptionKey","localStorage","getItem","urls","auth","api","init","newUrls","assign","data","options","_encryptObject","fields","obj","encryptedObject","index","length","ensureString","handleEncryption","constructor","preserveObjectShape","fieldsToEncrypt","keys","privateKey","_decryptArray","array","decryptedArr","Array","handleDecryption","_decryptObject","decryptedObject","logout","appId","removeItem","handleRedirect","refreshAccessToken","accessToken","refreshToken","requestBody","fetch","method","headers","body","JSON","stringify","res","json","checkAuth","urlKey","location","hash","substring","cachedPrivateKey","setUserKeysInStorage","withEvervault","WrappedComponent","APP_ID","AUTH_URL","API_URL","props","evervault","setState","state","React","Component","privateKeyBuffer","importKey","b64String","decodedStr","atob","buf","ArrayBuffer","bufView","charCodeAt","includes","toString","getString","trim","uint8Buf","sub","start","subarray","String","fromCharCode","apply","btoa","bufToStr","TextEncoder","encode","valueArr","split","prefix","version","test","buffer","decoder","TextDecoder","decode","encoded","bufferToB64","setItem","parse","haiku","url","queryParams","getParams","permittedParams","queryString","filter","queryParam","map","encodeURI","join","replace","params","search","substr","forEach","query","val","decodeURIComponent"],"mappings":"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","file":"index.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"react\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"react\"], factory);\n\telse {\n\t\tvar a = typeof exports === 'object' ? factory(require(\"react\")) : factory(root[\"react\"]);\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(window, function(__WEBPACK_EXTERNAL_MODULE__1__) {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 2);\n","/** @format */\n\nconst Utils = require('./utils');\n\nclass EvervaultKeyStore {\n  constructor() {\n    let _privateKey = undefined;\n\n    this.encryptString = (str) => {\n      const dataBuffer = Utils.dataToBuffer(str);\n      const iv = window.crypto.getRandomValues(new Uint8Array(12));\n      return window.crypto.subtle\n        .encrypt(\n          {\n            name: 'AES-GCM',\n            iv,\n          },\n          _privateKey,\n          dataBuffer\n        )\n        .then((enc) => Utils.buildEvervaultString(iv, enc))\n        .catch((err) => {\n          throw new Error('Encryption operation failed.');\n        });\n    };\n\n    this.decryptString = (str) => {\n      if (Utils.isEvervaultString(str)) {\n        const parsedData = Utils.parseEvervaultString(str);\n        const dataBuffer = Utils.b64ToBuffer(parsedData.browserData);\n        const ivBuffer = Utils.b64ToBuffer(parsedData.iv);\n        return window.crypto.subtle\n          .decrypt(\n            {\n              name: 'AES-GCM',\n              iv: ivBuffer,\n            },\n            _privateKey,\n            dataBuffer\n          )\n          .then((decryptedData) => {\n            return Utils.bufferToString(decryptedData);\n          })\n          .catch((error) => {\n            throw new Error(error);\n          });\n      }\n      return str;\n    };\n\n    this.updateKey = async (newKey) => {\n      if (!_privateKey) {\n        const keyObj = await Utils.getEncryptionKey(\n          newKey ? newKey : localStorage.getItem('evervault-privateKey')\n        );\n        _privateKey = keyObj;\n      }\n    };\n  }\n}\n\nmodule.exports = {\n  keyStore: new EvervaultKeyStore(),\n  urls: {\n    auth: 'https://auth.evervault.com',\n    api: 'https://api.evervault.com',\n  },\n\n  init: function(newUrls) {\n    Object.assign(this.urls, newUrls);\n  },\n\n  /**\n   * Encrypt your user's data with their evervault secret key\n   * @param {any} data - data to encrypt\n   * @param {Object} options - see readme for possible values\n   */\n  encrypt: function(data, options = {}) {\n    const _encryptObject = (data, fields) => {\n      if (data) {\n        const handleEncryption = async (obj, fields) => {\n          let encryptedObject = Object.assign({}, obj);\n          for (let index = 0; index < fields.length; index++) {\n            let key = fields[index];\n            if (encryptedObject[key]) {\n              encryptedObject[key] = await this.keyStore.encryptString(\n                Utils.ensureString(encryptedObject[key])\n              );\n            }\n          }\n          return encryptedObject;\n        };\n\n        return handleEncryption(data, fields);\n      }\n      //data is falsey - undefined\n      return;\n    };\n\n    if (\n      typeof data === 'object' &&\n      data &&\n      data.constructor.name !== 'Array' &&\n      options.preserveObjectShape\n    ) {\n      const fields = options.fieldsToEncrypt || Object.keys(data);\n      return this.keyStore.updateKey(options.privateKey).then(() => {\n        return _encryptObject(data, fields);\n      });\n    } else if (typeof data !== 'undefined' && typeof data !== 'symbol') {\n      return this.keyStore.updateKey(options.privateKey).then(() => {\n        return this.keyStore.encryptString(Utils.ensureString(data));\n      });\n    }\n    return;\n  },\n\n  /**\n   *\n   * @param {any} data - the data to be decrypted\n   * @param {String} privateKey - a string representation of the private key\n   */\n  decrypt: function(data, privateKey) {\n    const _decryptArray = (data) => {\n      const handleDecryption = async (array) => {\n        let decryptedArr = new Array(array.length);\n        for (let index = 0; index < data.length; index++) {\n          decryptedArr[index] = await this.keyStore.decryptString(\n            Utils.ensureString(array[index])\n          );\n        }\n        return decryptedArr;\n      };\n\n      return handleDecryption(data);\n    };\n\n    const _decryptObject = (data, fields) => {\n      if (data) {\n        const handleDecryption = async (obj, fields) => {\n          let decryptedObject = Object.assign({}, obj);\n          for (let index = 0; index < fields.length; index++) {\n            let key = fields[index];\n            if (decryptedObject[key]) {\n              decryptedObject[key] = await this.keyStore.decryptString(\n                Utils.ensureString(decryptedObject[key])\n              );\n            }\n          }\n          return decryptedObject;\n        };\n\n        return handleDecryption(data, fields);\n      }\n      //data is falsey - undefined\n      return;\n    };\n\n    if (typeof data === 'object') {\n      if (data.constructor.name === 'Array') {\n        return this.keyStore.updateKey(privateKey).then(() => {\n          return _decryptArray(data);\n        });\n      }\n      return this.keyStore.updateKey(privateKey).then(() => {\n        return _decryptObject(data, Object.keys(data));\n      });\n    } else if (typeof data !== 'undefined' && typeof data !== 'symbol') {\n      return this.keyStore.updateKey(privateKey).then(() => {\n        return this.keyStore.decryptString(Utils.ensureString(data));\n      });\n    }\n    return data;\n  },\n\n  /**\n   * delete a user's credentials and redirect them to evervault auth\n   * @param {string} appId - the unique identifier for the application given by the evervault dashboard\n   */\n  logout: function(appId) {\n    localStorage.removeItem('evervault-privateKey');\n    localStorage.removeItem('evervault-accessToken');\n    localStorage.removeItem('evervault-refreshToken');\n    localStorage.removeItem('evervault-haiku');\n    Utils.handleRedirect(`${this.urls.auth}/${appId}`);\n  },\n\n  /**\n   * Attempt to refresh the user's accesstoken using their refreshtoken\n   * @param {String} accessToken - the user's access token given by evervault auth\n   * @param {String} refreshToken - users's refresh token given by evervault auth\n   */\n  refreshAccessToken: function(accessToken, refreshToken) {\n    const requestBody = {\n      accessToken: accessToken || localStorage.getItem('evervault-accessToken'),\n      refreshToken:\n        refreshToken || localStorage.getItem('evervault-refreshToken'),\n    };\n    return fetch(`${this.urls.api}/v1/token/refresh`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify(requestBody),\n    })\n      .then((res) => res.json())\n      .then(({ accessToken }) => accessToken)\n      .catch((err) => {\n        throw err;\n      });\n  },\n\n  /**\n   * This function checks your user's auth status and will either redirect them to login, or\n   * will update their cached credentials\n   * @param [string] appId - unique identifier for your app as given on the evervault dashboard\n   */\n  checkAuth: function(appId) {\n    const urlKey = window.location.hash.substring(2);\n    window.location.hash = '/';\n    const cachedPrivateKey = localStorage.getItem('evervault-privateKey');\n    const accessToken = localStorage.getItem('evervault-accessToken');\n    const refreshToken = localStorage.getItem('evervault-refreshToken');\n\n    const hasStorageCredentials =\n      accessToken && refreshToken && cachedPrivateKey;\n\n    if (!hasStorageCredentials && !urlKey) {\n      Utils.handleRedirect(`${this.urls.auth}/${appId}`);\n    } else if (urlKey) {\n      //user has key in url but not stored in memory\n      Utils.setUserKeysInStorage(urlKey);\n    }\n  },\n};\n","module.exports = __WEBPACK_EXTERNAL_MODULE__1__;","import React from 'react';\nimport evervault from '@evervault/sdk'\n\nexport default function withEvervault(WrappedComponent, APP_ID, AUTH_URL, API_URL) {\n  return class extends React.Component {\n    state = {\n      evervault: null\n    }\n    \n    constructor(props) {\n      super(props);\n      evervault.init({auth: AUTH_URL, api: API_URL});\n      evervault.checkAuth(APP_ID);\n    }\n\n    componentDidMount() {\n      this.setState({\n        evervault\n      })\n    }\n    \n    render() {\n      return(\n        <WrappedComponent evervault={this.state.evervault} />\n      )\n    }\n  }\n}","/** @format */\n\nmodule.exports = class Utils {\n  static getEncryptionKey(privateKey) {\n    const privateKeyBuffer = this.b64ToBuffer(privateKey);\n    return window.crypto.subtle.importKey(\n      'raw',\n      privateKeyBuffer,\n      { name: 'AES-GCM' },\n      false,\n      ['encrypt', 'decrypt']\n    );\n  }\n\n  static b64ToBuffer(b64String) {\n    const decodedStr = window.atob(b64String);\n    var buf = new ArrayBuffer(decodedStr.length);\n    var bufView = new Uint8Array(buf);\n    for (var i = 0; i < decodedStr.length; i++) {\n      bufView[i] = decodedStr.charCodeAt(i);\n    }\n    return bufView;\n  }\n\n  static ensureString(data) {\n    const getString = (data) => {\n      const isString = typeof data === 'string';\n      if (!isString) {\n        if (['bigint', 'function'].includes(typeof data)) {\n          return data.toString();\n        }\n        return JSON.stringify(data);\n      }\n      return data;\n    };\n\n    return getString(data).trim();\n  }\n\n  static bufToStr(buf) {\n    const uint8Buf = new Uint8Array(buf);\n    const chunkLength = 8;\n    let i = 0,\n      str = '',\n      start = i * chunkLength;\n    let sub;\n\n    while (start + chunkLength < uint8Buf.length) {\n      sub = uint8Buf.subarray(start, start + chunkLength);\n      str += String.fromCharCode.apply(null, sub);\n      i++;\n      start = i * chunkLength;\n    }\n    str += String.fromCharCode.apply(null, uint8Buf.subarray(start));\n    return str;\n  }\n\n  static bufferToB64(buf) {\n    return window.btoa(this.bufToStr(buf));\n  }\n\n  static dataToBuffer(data) {\n    return new TextEncoder().encode(data);\n  }\n\n  static parseEvervaultString(str) {\n    const valueArr = str.split(':');\n    if (valueArr.length < 4) {\n      throw new Error('String does not match expected structure');\n    }\n    return {\n      prefix: valueArr[0],\n      version: valueArr[1],\n      iv: valueArr[2],\n      browserData: valueArr[3],\n    };\n  }\n\n  static isEvervaultString(str) {\n    const encryptionSchemeRegex = /^enc:v\\d:(?:[A-Za-z0-9+\\/]{4})*(?:[A-Za-z0-9+\\/]{2}==|[A-Za-z0-9+\\/]{3}=)?:(?:[A-Za-z0-9+\\/]{4})*(?:[A-Za-z0-9+\\/]{2}==|[A-Za-z0-9+\\/]{3}=)?$/s;\n    return encryptionSchemeRegex.test(str);\n  }\n\n  static bufferToString(buffer) {\n    const uint8Buf = new Uint8Array(buffer);\n    const chunkLength = 8;\n    let i = 0,\n      str = '',\n      start = i * chunkLength;\n    let sub;\n    let decoder = new TextDecoder('utf-8');\n    while (start + chunkLength < uint8Buf.length) {\n      sub = uint8Buf.subarray(start, start + chunkLength);\n      str += decoder.decode(sub);\n      i++;\n      start = i * chunkLength;\n    }\n    const decoded = decoder.decode(uint8Buf.subarray(start));\n    str += decoded;\n    return str;\n  }\n\n  static buildEvervaultString(iv, encoded) {\n    return `enc:v1:${this.bufferToB64(iv)}:${this.bufferToB64(encoded)}`;\n  }\n\n  static setUserKeysInStorage(urlKey) {\n    const keys = urlKey.split(':');\n    localStorage.setItem('evervault-privateKey', keys[0]);\n    localStorage.setItem('evervault-accessToken', keys[1]);\n    localStorage.setItem('evervault-refreshToken', keys[2]);\n    localStorage.setItem(\n      'evervault-haiku',\n      JSON.parse(window.atob(keys[1].split('.')[1])).haiku\n    );\n  }\n\n  static handleRedirect(url) {\n    const queryParams = Utils.getParams();\n    const permittedParams = ['redirectUrl', 'state', 'nonce'];\n    const validKeys = Object.keys(queryParams).filter((queryParam) =>\n      permittedParams.includes(queryParam)\n    );\n\n    const queryString = validKeys\n      .map((key) => `${key}=${encodeURI(queryParams[key])}`)\n      .join('&');\n    window.location.replace(`${url}?${queryString}`);\n  }\n\n  static getParams() {\n    let params = {};\n    window.location.search\n      .substr(1)\n      .split('&')\n      .forEach((query) => {\n        const [key, val] = query.split('=');\n        params[key] = decodeURIComponent(val);\n      });\n    return params;\n  }\n};\n"],"sourceRoot":""}